---
import { getLangFromUrl, useTranslations } from "../../i18n/utils";
import { getRelativeLocaleUrl } from "astro:i18n";

interface Props {
  slug: string;
  category: string;
  description: string;
  items: { name: string }[];
  icon: string;
  color: string;
}

const { category, description, items, color, slug } = Astro.props;
const lang = getLangFromUrl(Astro.url);
const t = useTranslations(lang);

const dynamicLink = getRelativeLocaleUrl(lang, `/layanan/${slug}`);
const themeColor =
  color === "orange" ? "#ea580c" : color === "green" ? "#16a34a" : "#548e9b";
---

<div
  class="inline-block w-[85vw] md:w-[380px] flex-shrink-0 snap-center p-3 group">
  <div
    class="relative h-[520px] transition-all duration-500 ease-out group-hover:-translate-y-2">
    <div
      class="absolute inset-0 rounded-[2.5rem] opacity-10 blur-2xl transition-opacity duration-500 group-hover:opacity-30"
      style={`background-color: ${themeColor};`}>
    </div>

    <div
      class="relative h-full w-full rounded-[2.5rem] bg-white/40 dark:bg-black/20 backdrop-blur-2xl border border-black/5 dark:border-white/10 flex flex-col p-8 overflow-hidden">
      <div class="relative z-10 mb-6">
        <div class="flex items-center gap-3 mb-6">
          <div
            class="h-1 w-8 rounded-full"
            style={`background-color: ${themeColor};`}>
          </div>
          <span
            class="text-[10px] font-black uppercase tracking-[0.2em] text-gray-500 dark:text-white/60 italic"
            >{t("services.badge")}</span
          >
        </div>

        <h3
          class="text-4xl font-black leading-[0.9] tracking-tighter uppercase mb-4 italic group-hover:not-italic transition-all text-gray-900 dark:text-white">
          {category.split(" ")[0]}<br />
          <span style={`color: ${themeColor};`}
            >{category.split(" ").slice(1).join(" ")}</span
          >
        </h3>

        <p
          class="text-sm font-medium leading-relaxed text-gray-700 dark:text-white/80 line-clamp-2">
          {description}
        </p>
      </div>

      <div class="relative z-10 mb-6">
        <div
          class="collapse collapse-arrow bg-black/5 dark:bg-white/5 border border-black/5 dark:border-white/10 rounded-2xl transition-colors hover:bg-black/10 dark:hover:bg-white/10">
          <input type="checkbox" class="peer" />
          <div
            class="collapse-title text-[9px] font-black uppercase tracking-widest text-gray-500 dark:text-white/50 min-h-0 py-3">
            SERVICE DETAILS
          </div>
          <div class="collapse-content px-4">
            <div
              class="space-y-2 pt-2 border-t border-black/5 dark:border-white/10">
              {
                items.map((item) => (
                  <div class="flex items-center gap-3 group/item">
                    <div
                      class="w-1 h-1 rounded-full opacity-40 group-hover/item:opacity-100"
                      style={`background-color: ${themeColor};`}
                    />
                    <span class="text-xs font-bold text-gray-800 dark:text-white/70 group-hover/item:text-gray-950 dark:group-hover/item:text-white transition-colors uppercase">
                      {item.name}
                    </span>
                  </div>
                ))
              }
            </div>
          </div>
        </div>
      </div>

      <div class="mt-auto relative z-10">
        <a
          href={dynamicLink}
          class="group/btn flex items-center justify-between w-full p-1 pl-6 bg-black/5 dark:bg-white/10 hover:bg-white rounded-full transition-all duration-500 border border-black/5 dark:border-white/10">
          <span
            class="text-[10px] font-black uppercase tracking-widest text-gray-800 dark:text-white group-hover/btn:text-black transition-colors"
            >{t("services.cta")}</span
          >
          <div
            class="w-12 h-12 rounded-full flex items-center justify-center transition-transform duration-500 group-hover/btn:rotate-[-45deg]"
            style={`background-color: ${themeColor};`}>
            <svg
              class="w-5 h-5 text-white"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
              ><path stroke-width="3" d="M17 8l4 4m0 0l-4 4m4-4H3"></path></svg
            >
          </div>
        </a>
      </div>
    </div>
  </div>
</div>
